/* шаблон оформляющий внешний вид раздела транзакции */

<!-- START BLOCK : moneys_in_stock -->
    <h4>На данный момент у нас в накоплениях: <span style="color: #00FF00">{total} р.</span></h4>
<!-- END BLOCK : moneys_in_stock -->

<!-- START BLOCK : no_money -->
    <h4>К сожалению бобла совершенно нет. Срочно несем бабос в казну. Казна у Саба. </h4>
<!-- END BLOCK : no_money -->


<!-- START BLOCK : list_balances -->
	Ваш баланс по отношению к пользователям<br>
    <div id="transaction_table">
        <table>
            <!-- START BLOCK : user_balance -->
                <tr>
                    <td>{user}</td>
                    <td>{balance} р.</td>
                </tr>
            <!-- END BLOCK : user_balance -->
        </table>    
    </div>
    <br><br>
<!-- END BLOCK : list_balances -->


<!-- START BLOCK : common_info -->
    Общая статистика
    <div id="transaction_table">
        <table>
	        <tr>
	            <td>Всего в Subminsk'е в наличии:</td>
	            <td>{budget} р.</td>
	        </tr>
	        <tr>
	            <td>Всего отправлено в Subminsk:</td>
	            <td>{transmit_to_budget} р.</td>
	        </tr>
	        <tr>
	            <td>Сумма отправленная в Космос:</td>
	            <td>{transmit_to_space} р.</td>
	        </tr>
	        <tr>
	            <td>Сумма отправленная в Космос из Subminsk'а:</td>
	            <td>{transmit_to_space_from_subminsk} р.</td>
	        </tr>
	        <tr>
	            <td>Сколько вернул космос в Subminsk:</td>
	            <td>{transmit_from_space_to_subminsk} р.</td>
	        </tr>
	        <tr>
	            <td>Сколько Subminsk объявил за всё время:</td>
	            <td>{subminsk_sum_to_users} р.</td>
	        </tr>
        </table>    
    </div>
    <br><br>
<!-- END BLOCK : common_info -->

<div id="transaction_table">
    Общая статистика по пользователям
    <table>
        <tr>
            <th>Всего отправил</th>
            <th>В Subminsk</th>
            <th>В Космос</th>
            <th>объявленные взносы в Subminsk</th>
        </tr>
        <!-- START BLOCK : user_info_row -->
            <tr>
                <td>{user}</td>
                <td>{subminsk_sum} р.</td>
                <td>{space_sum} р.</td>
                <td>{sum_fee} р.</td>
            </tr>
        <!--  END BLOCK : user_info_row -->
    </table>    
</div>

   

<!-- START BLOCK : list_transaction -->
    <!-- START BLOCK : moneys_was -->
        А когдато бабос был!<br>
    <!-- END BLOCK : moneys_was -->

	<br>
    Журнал транзакций
    <br>
    <div id="transaction_table">
        <table>
            <tr>
                <th>Номер</th>
                <th>Дата транзакции</th>
                <th>Дата передачи денег</th>
                <th>Отправитель</th>
                <th>Получатель</th>
                <th>Сумма</th>
                <th>Описание</th>
                <th>Создал транзакцию</th>
            </tr>
            <!-- START BLOCK : transaction -->
                <!-- START BLOCK : transaction_from_subminsk -->
                    <tr style="color: #0000FF">
                        <td>{id}</td>
                        <td>{created}</td>
                        <td>{date}</td>
                        <td>{src_user}</td>
                        <td>{dst_user}</td>
                        <td style="padding-left: 20px; padding-right: 20px;">{sum} р.</td>
                        <td style="max-width: 200px;">{reason}</td>
                        <td>{author_user}</td>
                    </tr>
                <!-- END BLOCK : transaction_from_subminsk -->
                <!-- START BLOCK : transaction_to_subminsk -->
                    <tr style="color: #00CFA0">
                        <td>{id}</td>
                        <td>{created}</td>
                        <td>{date}</td>
                        <td>{src_user}</td>
                        <td>{dst_user}</td>
                        <td style="padding-left: 20px; padding-right: 20px;">{sum} р.</td>
                        <td style="max-width: 200px;">{reason}</td>
                        <td>{author_user}</td>
                    </tr>
                <!-- END BLOCK : transaction_to_subminsk -->
                <!-- START BLOCK : transaction_to_space -->
                    <tr style="color: #DF8000">
                        <td>{id}</td>
                        <td>{created}</td>
                        <td>{date}</td>
                        <td>{src_user}</td>
                        <td>{dst_user}</td>
                        <td style="padding-left: 20px; padding-right: 20px;">{sum} р.</td>
                        <td style="max-width: 200px;">{reason}</td>
                        <td>{author_user}</td>
                    </tr>
                <!-- END BLOCK : transaction_to_space -->
                <!-- START BLOCK : transaction_from_users_to_users -->
                    <tr style="font-weight: bold">
                        <td>{id}</td>
                        <td>{created}</td>
                        <td>{date}</td>
                        <td>{src_user}</td>
                        <td>{dst_user}</td>
                        <td style="padding-left: 20px; padding-right: 20px;">{sum} р.</td>
                        <td style="max-width: 200px;">{reason}</td>
                        <td>{author_user}</td>
                    </tr>
                <!-- END BLOCK : transaction_from_users_to_users -->
            <!-- END BLOCK : transaction -->
        </table>
    </div>
    <br>
<!-- END BLOCK : list_transaction -->

<!-- START BLOCK : transaction_add -->
    <div align="center">
        <script>
            $(function()
            {
                $( "#transaction_date" ).datepicker({ dateFormat: "yy-mm-dd" });
            });

           function form1_check_fields() 
           {
               var forma;
               forma = document.getElementById("transaction_add");
               if (forma.src_user_id.value <= 0)
                   alert("Не выбран отправитель");
               else if (forma.sum.value < 0)
                   alert("Сумма не введена или равна нулю");
               else if (!forma.reason.value)
                   alert("Нужно ввести объяснение причины пополнения или списания");
               else if (!forma.date.value)
                   alert("Нужно указать дату передачи денег");
               else 
                   forma.submit();
           }
        </script>
        <div style="border: solid 2px #AAAAAA; margin: 10px; width:700px">
            <h2>Провести транзакцию</h2>
            <form name="form1" method="POST" action="{http_root}exchange.php" id="transaction_add">
                <input type="hidden" name="post_query" value="transaction_add">                     
                <table border="0" cellspacing="5" cellpadding="5">
                    <tr>
                        <td align="right" valign="top">Отправитель</td>
                        <td>
                            <select name="src_user_id">
                                <option value="0"></option>
                                <!-- START BLOCK : select_src_id -->
                                    <option value="{id}" {selected}>{name}</option>
                                <!-- END BLOCK : select_src_id -->
                            </select>
                        </td>
                    </tr>                    
                    <tr>
                        <td align="right" valign="top">Получатели</td>
                        <td>
                            <!-- START BLOCK : dst_user -->
                                <input type="checkbox" name="dst_users_id[{id}]"> {name}<br>
                            <!-- END BLOCK : dst_user -->
                        </td>
                    </tr>
                    <tr>
                        <td align="right" valign="top">Сумма</td>
                        <td><input type="text" name="sum" size="4" value="{sum}" ></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top">Описание транзакции</td>
                        <td>
                            <textarea style="height:150px;width:500px;" name="reason">{contents}</textarea>
                        </td>
                    </tr>
                    <tr>
                        <td align="right" valign="top">Дата операции</td>
                        <td><input style="width:150px;" type="text" name="date" value='{date}' id="transaction_date"></td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                        <div class="s_button_black">
                            <a href="javascript:;" onclick="form1_check_fields()" >Добавить</a>
                        </div>
                        </td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
    <br><br><br><br><br><br><br>
 <!-- END BLOCK : transaction_add -->

